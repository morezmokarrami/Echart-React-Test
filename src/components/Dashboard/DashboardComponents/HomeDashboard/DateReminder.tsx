import { useEffect, useState } from "react";
import { useAppSelector } from "../../../../hooks/reduxHook";
import moment from "jalali-moment";
import flag from "../../../../helpers/flags";

const calender = <svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none">
<path fillRule="evenodd" clipRule="evenodd" d="M14.8749 6.92822H1.50687C1.19637 6.92822 0.944366 6.67622 0.944366 6.36572C0.944366 6.05522 1.19637 5.80322 1.50687 5.80322H14.8749C15.1854 5.80322 15.4374 6.05522 15.4374 6.36572C15.4374 6.67622 15.1854 6.92822 14.8749 6.92822" fill="#666666"/>
<path fillRule="evenodd" clipRule="evenodd" d="M11.5259 9.85721C11.2154 9.85721 10.9604 9.60521 10.9604 9.29471C10.9604 8.98421 11.2086 8.73221 11.5191 8.73221H11.5259C11.8364 8.73221 12.0884 8.98421 12.0884 9.29471C12.0884 9.60521 11.8364 9.85721 11.5259 9.85721" fill="#666666"/>
<path fillRule="evenodd" clipRule="evenodd" d="M8.19776 9.85721C7.88726 9.85721 7.63226 9.60521 7.63226 9.29471C7.63226 8.98421 7.88051 8.73221 8.19101 8.73221H8.19776C8.50826 8.73221 8.76026 8.98421 8.76026 9.29471C8.76026 9.60521 8.50826 9.85721 8.19776 9.85721" fill="#666666"/>
<path fillRule="evenodd" clipRule="evenodd" d="M4.86267 9.85721C4.55217 9.85721 4.29642 9.60521 4.29642 9.29471C4.29642 8.98421 4.54542 8.73221 4.85592 8.73221H4.86267C5.17317 8.73221 5.42517 8.98421 5.42517 9.29471C5.42517 9.60521 5.17317 9.85721 4.86267 9.85721" fill="#666666"/>
<path fillRule="evenodd" clipRule="evenodd" d="M11.5259 12.7722C11.2154 12.7722 10.9604 12.5202 10.9604 12.2097C10.9604 11.8992 11.2086 11.6472 11.5191 11.6472H11.5259C11.8364 11.6472 12.0884 11.8992 12.0884 12.2097C12.0884 12.5202 11.8364 12.7722 11.5259 12.7722" fill="#666666"/>
<path fillRule="evenodd" clipRule="evenodd" d="M8.19776 12.7722C7.88726 12.7722 7.63226 12.5202 7.63226 12.2097C7.63226 11.8992 7.88051 11.6472 8.19101 11.6472H8.19776C8.50826 11.6472 8.76026 11.8992 8.76026 12.2097C8.76026 12.5202 8.50826 12.7722 8.19776 12.7722" fill="#666666"/>
<path fillRule="evenodd" clipRule="evenodd" d="M4.86267 12.7722C4.55217 12.7722 4.29642 12.5202 4.29642 12.2097C4.29642 11.8992 4.54542 11.6472 4.85592 11.6472H4.86267C5.17317 11.6472 5.42517 11.8992 5.42517 12.2097C5.42517 12.5202 5.17317 12.7722 4.86267 12.7722" fill="#666666"/>
<path fillRule="evenodd" clipRule="evenodd" d="M11.2201 3.84325C10.9096 3.84325 10.6576 3.59125 10.6576 3.28075V0.8125C10.6576 0.502 10.9096 0.25 11.2201 0.25C11.5306 0.25 11.7826 0.502 11.7826 0.8125V3.28075C11.7826 3.59125 11.5306 3.84325 11.2201 3.84325" fill="#666666"/>
<path fillRule="evenodd" clipRule="evenodd" d="M5.16147 3.84325C4.85097 3.84325 4.59897 3.59125 4.59897 3.28075V0.8125C4.59897 0.502 4.85097 0.25 5.16147 0.25C5.47197 0.25 5.72397 0.502 5.72397 0.8125V3.28075C5.72397 3.59125 5.47197 3.84325 5.16147 3.84325" fill="#666666"/>
<mask id="mask0_342_283" style={{maskType:"luminance"}} maskUnits="userSpaceOnUse" x="0" y="1" width="16" height="16">
  <path fillRule="evenodd" clipRule="evenodd" d="M0.875 1.43433H15.5V16.375H0.875V1.43433Z" fill="white"/>
</mask>
<g mask="url(#mask0_342_283)">
  <path fillRule="evenodd" clipRule="evenodd" d="M5.01575 2.55933C3.071 2.55933 2 3.59658 2 5.47983V12.2666C2 14.1911 3.071 15.2501 5.01575 15.2501H11.3593C13.304 15.2501 14.375 14.2106 14.375 12.3236V5.47983C14.378 4.55358 14.129 3.83358 13.6347 3.33858C13.1262 2.82858 12.3425 2.55933 11.366 2.55933H5.01575ZM11.3593 16.3751H5.01575C2.462 16.3751 0.875 14.8008 0.875 12.2666V5.47983C0.875 2.98383 2.462 1.43433 5.01575 1.43433H11.366C12.6477 1.43433 13.7075 1.81833 14.4313 2.54358C15.134 3.24933 15.5037 4.26408 15.5 5.48133V12.3236C15.5 14.8226 13.913 16.3751 11.3593 16.3751V16.3751Z" fill="#666666"/>
</g>
</svg>;

const setting = <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
<mask id="mask0_342_6" style={{maskType:"luminance"}} maskUnits="userSpaceOnUse" x="0" y="0" width="16" height="16">
  <path fillRule="evenodd" clipRule="evenodd" d="M0.875 0.000366211H15.3386V15.5411H0.875V0.000366211Z" fill="white"/>
</mask>
<g mask="url(#mask0_342_6)">
  <path fillRule="evenodd" clipRule="evenodd" d="M4.77665 11.5804C4.9484 11.5804 5.12015 11.6021 5.28815 11.6471C5.79515 11.7836 6.2354 12.1226 6.4964 12.5779C6.6659 12.8636 6.75965 13.1974 6.76265 13.5379C6.76265 14.0254 7.15415 14.4161 7.63565 14.4161H8.5754C9.05465 14.4161 9.44615 14.0276 9.4484 13.5484C9.4454 13.0189 9.6524 12.5156 10.0311 12.1369C10.4046 11.7634 10.9266 11.5391 11.4486 11.5541C11.7906 11.5624 12.1199 11.6546 12.4101 11.8196C12.8279 12.0589 13.3611 11.9164 13.6026 11.5039L14.1006 10.6736C14.2116 10.4824 14.2439 10.2424 14.1846 10.0211C14.1261 9.79987 13.9791 9.60787 13.7811 9.49462C13.3176 9.22762 12.9869 8.79712 12.8496 8.28112C12.7139 7.77487 12.7881 7.22212 13.0529 6.76687C13.2254 6.46687 13.4781 6.21412 13.7811 6.04012C14.1876 5.80237 14.3301 5.27062 14.0939 4.85662C14.0841 4.84012 14.0751 4.82287 14.0676 4.80487L13.6281 4.04287C13.3889 3.62662 12.8564 3.48337 12.4386 3.72112C11.9871 3.98812 11.4501 4.06462 10.9341 3.92887C10.4189 3.79537 9.9869 3.46912 9.71765 3.00862C9.54515 2.72062 9.4514 2.38537 9.4484 2.04412C9.45515 1.78762 9.36515 1.55737 9.20165 1.38862C9.0389 1.22062 8.81015 1.12537 8.5754 1.12537H7.63565C7.40315 1.12537 7.18565 1.21612 7.0214 1.37962C6.8579 1.54387 6.76865 1.76212 6.77015 1.99462C6.7544 3.09112 5.85815 3.97387 4.7729 3.97387C4.4249 3.97012 4.08965 3.87637 3.79865 3.70237C3.3899 3.46987 2.8559 3.61312 2.61665 4.02937L2.1089 4.86412C1.8764 5.26762 2.0189 5.80087 2.4329 6.04162C3.04715 6.39712 3.4304 7.06012 3.4304 7.77112C3.4304 8.48212 3.04715 9.14437 2.4314 9.50062C2.01965 9.73912 1.87715 10.2694 2.11565 10.6819L2.5889 11.4979C2.7059 11.7086 2.89715 11.8609 3.1184 11.9231C3.3389 11.9846 3.5819 11.9584 3.7844 11.8459C4.08215 11.6711 4.42865 11.5804 4.77665 11.5804M8.5754 15.5411H7.63565C6.5339 15.5411 5.63765 14.6456 5.63765 13.5439C5.63615 13.4081 5.59715 13.2671 5.5244 13.1449C5.40665 12.9394 5.21615 12.7924 4.9964 12.7339C4.77815 12.6754 4.5389 12.7076 4.3424 12.8216C3.8714 13.0841 3.31715 13.1479 2.81015 13.0054C2.3039 12.8621 1.86665 12.5141 1.61015 12.0529L1.1414 11.2451C0.593148 10.2941 0.919398 9.07537 1.8689 8.52637C2.13815 8.37112 2.3054 8.08162 2.3054 7.77112C2.3054 7.46062 2.13815 7.17037 1.8689 7.01512C0.918648 6.46312 0.593148 5.24137 1.14065 4.29037L1.64915 3.45562C2.1899 2.51512 3.4124 2.18362 4.36565 2.73112C4.4954 2.80837 4.6364 2.84737 4.77965 2.84887C5.2469 2.84887 5.63765 2.46337 5.64515 1.98937C5.64215 1.46662 5.8484 0.964866 6.22415 0.586116C6.6014 0.208116 7.1024 0.000366211 7.63565 0.000366211H8.5754C9.1124 0.000366211 9.6344 0.220866 10.0086 0.604116C10.3821 0.989616 10.5884 1.51837 10.5726 2.05462C10.5741 2.17537 10.6139 2.31487 10.6859 2.43712C10.8051 2.63962 10.9934 2.78212 11.2169 2.84062C11.4404 2.89612 11.6744 2.86612 11.8731 2.74837C12.8331 2.20012 14.0549 2.52862 14.6031 3.48112L15.0704 4.29037C15.0824 4.31212 15.0929 4.33312 15.1019 4.35487C15.5984 5.29312 15.2669 6.47437 14.3444 7.01362C14.2101 7.09087 14.1014 7.19887 14.0264 7.32937C13.9101 7.53112 13.8779 7.77112 13.9364 7.99162C13.9964 8.21662 14.1396 8.40337 14.3414 8.51887C14.7966 8.78062 15.1364 9.22162 15.2721 9.73087C15.4079 10.2394 15.3336 10.7914 15.0689 11.2466L14.5709 12.0761C14.0226 13.0181 12.8009 13.3444 11.8506 12.7954C11.7239 12.7226 11.5776 12.6829 11.4321 12.6791H11.4276C11.2109 12.6791 10.9881 12.7714 10.8261 12.9326C10.6619 13.0969 10.5719 13.3159 10.5734 13.5484C10.5681 14.6501 9.6719 15.5411 8.5754 15.5411" fill="#666666"/>
</g>
<path fillRule="evenodd" clipRule="evenodd" d="M8.10884 6.35593C7.32884 6.35593 6.69434 6.99118 6.69434 7.77118C6.69434 8.55118 7.32884 9.18493 8.10884 9.18493C8.88884 9.18493 9.52334 8.55118 9.52334 7.77118C9.52334 6.99118 8.88884 6.35593 8.10884 6.35593M8.10884 10.3099C6.70859 10.3099 5.56934 9.17143 5.56934 7.77118C5.56934 6.37093 6.70859 5.23093 8.10884 5.23093C9.50909 5.23093 10.6483 6.37093 10.6483 7.77118C10.6483 9.17143 9.50909 10.3099 8.10884 10.3099" fill="#666666"/>
</svg>

const downArrow = <svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none">
<g clipPath="url(#clip0_0_1805)">
  <path d="M4 6.5L8 10.5L12 6.5" stroke="#4D4D4D" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
</g>
<defs>
  <clipPath id="clip0_0_1805">
    <rect width="16" height="16" fill="white" transform="translate(0 0.5)"/>
  </clipPath>
</defs>
</svg>



const DateReminder = () => {

     const {firstRace} = useAppSelector(state => state.main);  

     const [remaining, setRemaining] = useState<number | string>('')
     const remainingWeeks = (d1: string  , d2: string  ) => {
          return Math.round((new Date(d2).getTime() - new Date(d1).getTime()) / (7 * 24 * 60 * 60 * 1000));
     }

     useEffect(() => {
          if (firstRace?.date?.length > 0) {
               setRemaining(remainingWeeks(moment(new Date() , 'YYYY/MM/DD').locale('fa').format('YYYY-MM-DD'), firstRace.date))
          }
     }, [firstRace])


     return (
          <div className="flex lg:w-full lg:mx-10 justify-center lg:justify-start mt-5 items-center">
               <div className="flex rounded-lg justify-between items-center bg-gray-200 px-3 py-1 mx-3 w-full lg:w-auto">
                    <div className="mr-5">
                         {downArrow}
                    </div>
                    <div className="text-sm flex items-center" dir="rtl">
                         {remaining} هفته تا {flag({country: firstRace.location})} {firstRace.name}
                    </div>
               </div>
               <div className="mx-3">
                    {calender}
               </div>
               <div className="mx-3">
                    {setting}
               </div>
          </div>
     )
}

export default DateReminder;